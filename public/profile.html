<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Reels - Profile</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="./app-styles.css">
</head>
<body class="bg-gray-50 flex justify-center items-center min-h-screen py-12">

    <div class="floating-animation relative">
        <div class="phone-mockup w-[320px] h-[640px] rounded-[3rem] p-3 relative">
            <div class="phone-screen w-full h-full rounded-[2.5rem] overflow-hidden relative">
                <div class="absolute top-0 left-1/2 transform -translate-x-1/2 w-32 h-6 bg-black rounded-b-2xl z-10"></div>
                <div class="w-full h-full bg-white overflow-hidden flex flex-col">
                    
                    <div id="profile-view-container" class="flex-1 flex flex-col bg-gray-50 overflow-hidden">
                        <!-- All views are dynamically generated by JS -->
                    </div>

                    <footer class="bg-white border-t border-gray-200 px-4 py-2 flex items-center justify-around">
                        <a href="/main.html" class="flex flex-col items-center py-1 text-gray-400"><p>ë©”ì¸</p></a>
                        <a href="/reels.html" class="flex flex-col items-center py-1 text-gray-400"><p>ë¦´ìŠ¤</p></a>
                        <a href="/profile.html" class="flex flex-col items-center py-1 text-orange-500"><div class="bg-orange-500 rounded-2xl px-4 py-2"><p class="text-white text-sm">ë§ˆì´í˜ì´ì§€</p></div></a>
                    </footer>
                </div>
                <div class="absolute bottom-2 left-1/2 transform -translate-x-1/2 w-32 h-1 bg-white/30 rounded-full"></div>
            </div>
        </div>
        <div class="absolute inset-0 rounded-[3rem] bg-gradient-to-br from-white/10 via-transparent to-transparent pointer-events-none"></div>
    </div>

    <script src="/__/firebase/12.3.0/firebase-app-compat.js"></script>
    <script src="/__/firebase/12.3.0/firebase-auth-compat.js"></script>
    <script src="/__/firebase/init.js"></script>
    <script src="./app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const viewContainer = document.getElementById('profile-view-container');
            const auth = firebase.auth();

            // --- DATA FOR DEMO ---
            let userData = { name: "Abdumalik Aliyev", email: "loading...", phone: "010-1234-5678" };
            let paymentMethods = [ { id: 1, name: "ì‹ í•œì¹´ë“œ ****1234", isDefault: true, type: "ì‹ ìš©ì¹´ë“œ", expiry: "12/26" }, { id: 2, name: "êµ­ë¯¼ì€í–‰ ****5678", isDefault: false, type: "ì²´í¬ì¹´ë“œ", expiry: "08/25" }];
            let addresses = [ { id: 1, name: "ì§‘", address: "ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123", detail: "101ë™ 1001í˜¸", isDefault: true }, { id: 2, name: "íšŒì‚¬", address: "ì„œìš¸ì‹œ ì„œì´ˆêµ¬ ì„œì´ˆëŒ€ë¡œ 456", detail: "Aë™ 5ì¸µ", isDefault: false }];
            let reviews = [ { id: 1, restaurant: "ëŒ€ë°•ê°ˆë¹„ì§‘", rating: 5, comment: "ì •ë§ ë§›ìˆì—ˆì–´ìš”! ê°ˆë¹„ê°€ ë¶€ë“œëŸ½ê³  ë°‘ë°˜ì°¬ë„ ê¹”ë”í–ˆìŠµë‹ˆë‹¤.", date: "2024-01-16", image: "/main-media/foodg.jpg", helpful: 12 }];

            // --- VIEW TEMPLATES (NOW WITH FULL HTML) ---
            const mainProfileView = () => `
                <header class="bg-green-500 px-4 pt-8 pb-6">
                    <div class="flex items-center gap-4">
                        <div class="w-16 h-16 rounded-full border-2 border-white overflow-hidden"><img src="/main-media/profileimg.jpg" alt="Profile" class="w-full h-full object-cover"/></div>
                        <div class="text-white">
                            <h2 class="text-xl font-bold">${userData.name}</h2>
                            <p class="text-green-100 text-sm" id="user-email">${userData.email}</p>
                        </div>
                    </div>
                </header>
                <div class="bg-white p-4 border-b border-gray-100"><div class="grid grid-cols-4 gap-4">
                    <button data-view="order-history" class="view-btn flex flex-col items-center p-3 rounded-lg hover:bg-gray-50"><span class="text-xl">ğŸ§¾</span><span class="text-xs text-gray-700">ì£¼ë¬¸ë‚´ì—­</span></button>
                    <button class="flex flex-col items-center p-3 rounded-lg hover:bg-gray-50"><span class="text-xl">â¤ï¸</span><span class="text-xs text-gray-700">ì°œ</span></button>
                    <button class="flex flex-col items-center p-3 rounded-lg hover:bg-gray-50"><span class="text-xl">ğŸ</span><span class="text-xs text-gray-700">ì¿ í°</span></button>
                    <button class="flex flex-col items-center p-3 rounded-lg hover:bg-gray-50"><span class="text-xl">ğŸ§</span><span class="text-xs text-gray-700">ê³ ê°ì„¼í„°</span></button>
                </div></div>
                <main class="flex-1 overflow-y-auto"><div class="bg-white">
                    <button data-view="order-history" class="view-btn w-full flex items-center justify-between p-4 hover:bg-gray-50 border-b border-gray-100"><span>ì£¼ë¬¸ ë‚´ì—­</span><span>&gt;</span></button>
                    <button data-view="payment" class="view-btn w-full flex items-center justify-between p-4 hover:bg-gray-50 border-b border-gray-100"><span>ê²°ì œ ìˆ˜ë‹¨</span><span>&gt;</span></button>
                    <button data-view="address" class="view-btn w-full flex items-center justify-between p-4 hover:bg-gray-50 border-b border-gray-100"><span>ë°°ì†¡ì§€ ê´€ë¦¬</span><span>&gt;</span></button>
                    <button data-view="reviews" class="view-btn w-full flex items-center justify-between p-4 hover:bg-gray-50 border-b border-gray-100"><span>ë¦¬ë·° ê´€ë¦¬</span><span>&gt;</span></button>
                    <button data-view="notifications" class="view-btn w-full flex items-center justify-between p-4 hover:bg-gray-50 border-b border-gray-100"><span>ì•Œë¦¼ ì„¤ì •</span><span>&gt;</span></button>
                    <button data-view="settings" class="view-btn w-full flex items-center justify-between p-4 hover:bg-gray-50 border-b border-gray-100"><span>ì„¤ì •</span><span>&gt;</span></button>
                    <button id="logout-btn" class="w-full flex items-center justify-between p-4 hover:bg-gray-50 text-red-500"><span>ë¡œê·¸ì•„ì›ƒ</span><span>&gt;</span></button>
                </div></main>`;
            
            const subPageView = (title, content) => `
                <header class="flex items-center p-4 pt-8 border-b border-gray-200 bg-white">
                    <button data-view="main" class="view-btn mr-3"><svg class="w-6 h-6 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg></button>
                    <h1 class="text-lg font-semibold">${title}</h1>
                </header>
                <main class="flex-1 overflow-y-auto p-4">${content}</main>`;

            const generateOrderHistoryContent = () => {
                const orders = JSON.parse(localStorage.getItem('orderHistory')) || [];
                if (orders.length === 0) return `<div class="text-center py-12"><p class="text-gray-500">ì£¼ë¬¸ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</p></div>`;
                return orders.map(o => `
                    <div class="bg-white border border-gray-200 rounded-lg p-4 mb-4">
                        <div class="flex items-start gap-3"><div class="w-16 h-16 rounded-lg overflow-hidden mr-3"><img src="${o.image}" alt="${o.restaurant}" class="w-full h-full object-cover"/></div>
                        <div class="flex-1">
                            <div class="flex justify-between items-start mb-1"><h3 class="font-semibold text-gray-900">${o.restaurant}</h3><span class="text-sm font-medium px-2 py-1 rounded-full bg-green-100 text-green-600">${o.status}</span></div>
                            <p class="text-sm text-gray-600 mb-2">${o.date}</p>
                            <div class="flex justify-between items-center"><p class="text-lg font-bold text-gray-900">${o.total}</p><div class="flex gap-2"><button class="text-sm text-green-600 border border-green-600 px-3 py-1 rounded-full hover:bg-green-50">ì¬ì£¼ë¬¸</button></div></div>
                        </div></div>
                    </div>`).join('');
            };
            const generatePaymentContent = () => paymentMethods.map(p => `
                <div class="bg-white border border-gray-200 rounded-lg p-4 mb-4">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center gap-3"><div><p class="font-semibold text-gray-900">${p.name}</p><p class="text-sm text-gray-600">${p.type}</p></div></div>
                        ${p.isDefault ? '<span class="text-xs bg-green-100 text-green-600 px-2 py-1 rounded-full">ê¸°ë³¸</span>' : ''}
                    </div>
                    <div class="flex items-center justify-between text-sm text-gray-600 mb-3"><span>ë§Œë£Œì¼: ${p.expiry}</span><span class="text-green-600">í™œì„±</span></div>
                    <div class="flex gap-2"><button class="flex-1 text-sm text-green-600 border border-green-600 py-2 rounded-lg hover:bg-green-50" ${p.isDefault ? 'disabled' : ''}>${p.isDefault ? "ê¸°ë³¸ ê²°ì œìˆ˜ë‹¨" : "ê¸°ë³¸ìœ¼ë¡œ ì„¤ì •"}</button><button class="flex-1 text-sm text-red-600 border border-red-600 py-2 rounded-lg hover:bg-red-50">ì‚­ì œ</button></div>
                </div>`).join('') + `<button class="w-full bg-green-500 text-white py-3 rounded-lg font-medium">ê²°ì œ ìˆ˜ë‹¨ ì¶”ê°€</button>`;
            const generateAddressContent = () => addresses.map(a => `
                <div class="bg-white border border-gray-200 rounded-lg p-4 mb-4">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center gap-3"><div><div class="flex items-center gap-2 mb-1"><span class="font-semibold text-gray-900">${a.name}</span>${a.isDefault ? '<span class="text-xs bg-green-100 text-green-600 px-2 py-1 rounded-full">ê¸°ë³¸</span>' : ''}</div><p class="text-sm text-gray-600">${a.address}</p><p class="text-sm text-gray-500">${a.detail}</p></div></div>
                    </div>
                    <div class="flex gap-2 mt-3"><button class="flex-1 text-sm text-green-600 border border-green-600 py-2 rounded-lg hover:bg-green-50" ${a.isDefault ? 'disabled' : ''}>${a.isDefault ? "ê¸°ë³¸ ë°°ì†¡ì§€" : "ê¸°ë³¸ìœ¼ë¡œ ì„¤ì •"}</button><button class="flex-1 text-sm text-gray-600 border border-gray-300 py-2 rounded-lg hover:bg-gray-50">ìˆ˜ì •</button><button class="flex-1 text-sm text-red-600 border border-red-600 py-2 rounded-lg hover:bg-red-50">ì‚­ì œ</button></div>
                </div>`).join('') + `<div class="my-4 h-40 bg-gray-200 rounded-lg flex items-center justify-center text-gray-500"><img src="https://maps.googleapis.com/maps/api/staticmap?center=35.8469,127.1293&zoom=15&size=300x150&markers=color:red%7C35.8469,127.1293&key=YOUR_API_KEY" alt="Map of Jeonju" class="w-full h-full object-cover rounded-lg"/></div><p class="text-xs text-center text-gray-400 mb-2">Note: Static map requires a Google Maps API key.</p>` + `<button class="w-full bg-green-500 text-white py-3 rounded-lg font-medium">ë°°ì†¡ì§€ ì¶”ê°€</button>`;
            const generateReviewsContent = () => reviews.map(r => `
                <div class="bg-white border border-gray-200 rounded-lg p-4 mb-4">
                    <div class="flex items-start gap-3 mb-3"><div class="w-16 h-16 rounded-lg overflow-hidden"><img src="${r.image}" alt="${r.restaurant}" class="w-full h-full object-cover"/></div>
                    <div class="flex-1"><div class="flex items-center justify-between mb-1"><h3 class="font-semibold text-gray-900">${r.restaurant}</h3><span class="text-sm text-gray-500">${r.date}</span></div><div class="flex items-center gap-1 mb-2">${[...Array(5)].map((_, i) => `<svg class="w-4 h-4 ${i < r.rating ? "text-yellow-400 fill-current" : "text-gray-300"}" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>`).join('')}<span class="text-sm text-gray-600 ml-1">(${r.rating}/5)</span></div></div></div>
                    <p class="text-gray-800 text-sm leading-relaxed mb-3">${r.comment}</p>
                    <div class="flex items-center justify-between text-sm"><div class="flex items-center gap-1 text-gray-500"><span>ë„ì›€ë¨ ${r.helpful}</span></div><div class="flex gap-2"><button class="text-green-600 border border-green-600 px-3 py-1 rounded-full hover:bg-green-50">ìˆ˜ì •</button><button class="text-red-600 border border-red-600 px-3 py-1 rounded-full hover:bg-red-50">ì‚­ì œ</button></div></div>
                </div>`).join('');
            const generateNotificationsContent = () => `<div class="space-y-4"><div class="bg-white rounded-lg p-4 border"><h3 class="font-medium mb-4">ì¼ë°˜ ì•Œë¦¼</h3><div class="space-y-4"><div class="flex items-center justify-between"><div><span class="text-sm font-medium text-gray-900">í‘¸ì‹œ ì•Œë¦¼</span><p class="text-xs text-gray-500">ì•± ì•Œë¦¼ì„ ë°›ìŠµë‹ˆë‹¤</p></div><input type="checkbox" class="toggle" checked /></div><div class="flex items-center justify-between"><div><span class="text-sm font-medium text-gray-900">ì´ë©”ì¼ ì•Œë¦¼</span><p class="text-xs text-gray-500">ì´ë©”ì¼ë¡œ ì•Œë¦¼ì„ ë°›ìŠµë‹ˆë‹¤</p></div><input type="checkbox" class="toggle"/></div></div></div><div class="bg-white rounded-lg p-4 border"><h3 class="font-medium mb-4">ì£¼ë¬¸ ì•Œë¦¼</h3><div class="space-y-4"><div class="flex items-center justify-between"><div><span class="text-sm font-medium text-gray-900">ì£¼ë¬¸ ìƒíƒœ ì—…ë°ì´íŠ¸</span><p class="text-xs text-gray-500">ì£¼ë¬¸ ì ‘ìˆ˜, ì¡°ë¦¬, ë°°ì†¡ ìƒíƒœ ì•Œë¦¼</p></div><input type="checkbox" class="toggle" checked/></div></div></div></div>`;
            const generateSettingsContent = () => `<div class="space-y-4"><div class="bg-white rounded-lg p-4 border"><h3 class="font-medium mb-4">ê°œì¸ì •ë³´</h3><div class="space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-2">ì´ë¦„</label><input type="text" value="${userData.name}" class="w-full p-3 border border-gray-300 rounded-lg"/></div><div><label class="block text-sm font-medium text-gray-700 mb-2">ì´ë©”ì¼</label><input type="email" value="${userData.email}" class="w-full p-3 border border-gray-300 rounded-lg"/></div><div><label class="block text-sm font-medium text-gray-700 mb-2">ì „í™”ë²ˆí˜¸</label><input type="tel" value="${userData.phone}" class="w-full p-3 border border-gray-300 rounded-lg"/></div><button class="w-full bg-green-500 text-white py-3 rounded-lg font-medium">ê°œì¸ì •ë³´ ìˆ˜ì •</button></div></div></div>`;

            const views = {
                'main': mainProfileView(),
                'order-history': subPageView('ì£¼ë¬¸ ë‚´ì—­', generateOrderHistoryContent()),
                'payment': subPageView('ê²°ì œ ìˆ˜ë‹¨', generatePaymentContent()),
                'address': subPageView('ë°°ì†¡ì§€ ê´€ë¦¬', generateAddressContent()),
                'reviews': subPageView('ë¦¬ë·° ê´€ë¦¬', generateReviewsContent()),
                'notifications': subPageView('ì•Œë¦¼ ì„¤ì •', generateNotificationsContent()),
                'settings': subPageView('ì„¤ì •', generateSettingsContent()),
            };

            function navigateTo(viewName) {
                viewContainer.innerHTML = views[viewName];
                if (viewName === 'main' && document.getElementById('logout-btn')) {
                    document.getElementById('logout-btn').addEventListener('click', () => auth.signOut());
                }
            }

            viewContainer.addEventListener('click', (e) => {
                const viewBtn = e.target.closest('.view-btn');
                if (viewBtn && viewBtn.dataset.view) {
                    navigateTo(viewBtn.dataset.view);
                }
            });
            
            auth.onAuthStateChanged(user => {
                if(user) {
                    userData.email = user.email;
                }
                navigateTo('main');
            });
        });
    </script>
</body>
</html>

 